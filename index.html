<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Raised Bed Diagram</title>
  <style>
    body { font-family: Arial, sans-serif; background: #efefef; }
    canvas {
      border: 2px solid #444;
      background: #fafafa;
      display: block;
      margin: 20px auto;
      border-radius: 8px;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
    }
    #info, #calendar {
      width: 1400px;
      margin: 10px auto;
      padding: 15px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-shadow: inset 1px 1px 5px rgba(0,0,0,0.03);
    }
    #info h3 { margin: 0 0 8px; color: #333; }
    #info p { margin: 0; color: #555; line-height: 1.4; }
    #calendar h3 { margin-top: 0; }
    .day {
      display: inline-block;
      width: 170px;
      margin: 5px;
      padding: 10px;
      border-radius: 6px;
      background: #f0f0f0;
      text-align: left;
      vertical-align: top;
    }
    .calendar-toggle {
      display: block;
      margin: 10px auto;
      text-align: center;
      cursor: pointer;
      color: #007acc;
      text-decoration: underline;
    }
    .download-link {
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <canvas id="gardenCanvas" width="900" height="900"></canvas>
  <div id="info"><em>Click a section to see plant care instructions.</em></div>
  <div class="calendar-toggle" id="calendarToggle">Show Weekly Care Calendar</div>
  <div id="calendar" style="display:none"></div>
  <div class="download-link">
    <a id="downloadSchedule" href="#" download="full_schedule.txt">Download Full Schedule</a>
  </div>
  <script>
    const plantingDate = new Date('2024-04-20');

const fullSchedule = { 
      Zucchini: ['Apr 20: Transplant outdoors', 'Apr 27: Water deeply; apply fertilizer', 'May 25: Plants 12-18in tall with flowers', 'Jun 15-20: First harvest expected (55-60 days)', 'Aug 1: Peak production'], 
      Blueberry: ['Apr 20: Established plant', 'Apr 22: Mulch with pine needles; water deeply', 'May 15: New spring growth established', 'Jun 1: Flowering period', 'Jul-Aug: Possible light harvest in first year'], 
      Blackberry: ['Apr 20: Established plant', 'Apr 25: Train vines on trellis', 'May 15: New cane growth 12-24in long', 'Jun 10: Flowering begins', 'Jul-Aug: Possible light harvest in first year'],       
      Carrot: ['Apr 20: Sow seeds', 'Apr 30: Seedlings emerge', 'May 10: Thin seedlings to 2in apart', 'Jun 1: Tops 6-8in tall', 'Jun 30-Jul 15: Begin harvest (70-85 days)'], 
      HotPepper: ['Apr 20: Transplant outdoors', 'May 5: Apply fertilizer; new growth established', 'Jun 15: Flowering begins', 'Jul 15-25: First peppers ready (85-95 days)', 'Aug 15: Peak production'], 
      SweetPepper: ['Apr 20: Transplant outdoors', 'May 5: Apply fertilizer; new growth established', 'Jun 15: Flowering begins', 'Jul 20-30: First peppers ready (90-100 days)', 'Aug 20: Peak production'], 
      StrawberryWhite: ['Apr 20: Transplant outdoors', 'Apr 27: Apply fertilizer', 'May 15: Flower development begins', 'Jun 15: First berries ripen (55 days)', 'Jul 1: Peak production'], 
      Celery: ['Apr 20: Transplant outdoors', 'Apr 27: Apply rich compost', 'May 25: Plants 8-12in tall', 'Jul 15-25: Begin harvest (85-95 days)', 'Aug 1: Stalks at ideal size'], 
      TomatoCherry: ['Apr 20: Transplant outdoors', 'Apr 24: Stake or cage plants', 'May 20: Plants 24-36in tall', 'Jul 1-10: First tomatoes ripen (70-80 days)', 'Aug 1: Peak production'], 
      TomatoRoma: ['Apr 20: Transplant outdoors', 'Apr 24: Stake or cage plants', 'May 20: Plants 24-30in tall', 'Jul 5-15: First tomatoes ripen (75-85 days)', 'Aug 1: Peak production'], 
      StrawberryEverbearing: ['Apr 20: Transplant outdoors', 'Apr 27: Apply fertilizer', 'May 15: Remove first flowers to strengthen plants', 'Jun 20-Jul 1: First berries ripen (60-70 days)', 'Aug-Sep: Second major fruiting period']
    };

    function camelCaseToSpaced(str) {
  // Replace any capital letter with a space followed by the lowercase version of that letter
  // Then capitalize the first letter of the result
  return str
    .replace(/([A-Z])/g, ' $1')
    .replace(/^\s/, '')
    .trim();
}

    function toggleCalendar() {
      if (calendarDiv.style.display === 'none') {
        calendarDiv.style.display = 'block';
        const today = new Date();
        const start = new Date(today);
        start.setDate(today.getDate() - today.getDay());
        let html = '<h3>This Week\'s Care Calendar</h3>';
        for (let i = 0; i < 7; i++) {
          const date = new Date(start);
          date.setDate(start.getDate() + i);
          const dayName = date.toLocaleDateString(undefined, { weekday: 'short' });
          const dateStr = date.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
          html += `<div class="day"><u><strong>${dayName} (${dateStr})</strong></u><br/><br/>`;
          for (const [plant, tasks] of Object.entries(fullSchedule)) {
            plant_spaced = camelCaseToSpaced(plant);
            const thisDay = `${dateStr}`;
            const matches = tasks.filter(t => t.includes(dateStr));
            if (matches.length) {
              html += `<em>${plant_spaced}</em><ul style="padding-left:8px;text-align:left;">`;
              matches.forEach(task => html += `<li>${task.split(': ')[1]}</li>`);
              html += '</ul>';
            }
          }
          html += '</div>';
        }
        calendarDiv.innerHTML = html;
      } else {
        calendarDiv.style.display = 'none';
      }
    }

    const scheduleText = Object.entries(fullSchedule).map(([plant, tasks]) => {
      return `${plant}\n${tasks.map(t => ' - ' + t).join('\n')}`;
    }).join('\n\n');
    document.getElementById('downloadSchedule').href = URL.createObjectURL(new Blob([scheduleText], { type: 'text/plain' }));
  </script>
  <script>
    const canvas = document.getElementById('gardenCanvas');
    const ctx = canvas.getContext('2d');
    const infoDiv = document.getElementById('info');
    const calendarDiv = document.getElementById('calendar');
    const toggleBtn = document.getElementById('calendarToggle');
    toggleBtn.addEventListener('click', toggleCalendar);

    const dpr = window.devicePixelRatio || 1;
    const displaySize = 900;
    canvas.width = displaySize * dpr;
    canvas.height = displaySize * dpr;
    canvas.style.width = `${displaySize}px`;
    canvas.style.height = `${displaySize}px`;
    ctx.scale(dpr, dpr);

    const gridSize = 6;
    const cellSize = displaySize / gridSize;
    let selectedIndex = null;

    const plantMap = {
      1: "Zucchini", 2: "Blueberry", 3: "Blackberry",
      4: "Carrots", 5: "Carrots", 6: "Carrots",
      7: "Hot Pepper", 8: "Sweet Pepper", 9: "White Strawberry",
      10: "Carrots", 11: "Carrots", 12: "Carrots",
      13: "Celery", 14: "Celery", 15: "",
      16: "Everbearing Strawberry", 17: "Everbearing Strawberry", 18: "Everbearing Strawberry",
      19: "Cherry Tomato", 20: "Celery", 21: "Celery",
      22: "Everbearing Strawberry", 23: "Everbearing Strawberry", 24: "Everbearing Strawberry",
      25: "", 26: "Celery", 27: "Celery",
      28: "Everbearing Strawberry", 29: "Everbearing Strawberry", 30: "Everbearing Strawberry",
      31: "Cherry Tomato", 32: "Roma Tomato", 33: "Sweet Pepper",
      34: "Everbearing Strawberry", 35: "Everbearing Strawberry", 36: "Everbearing Strawberry"
    };

    const styleMap = {
      "Zucchini": { color: '#d5f5e3', emoji: 'ü•í' },
      "Blueberry": { color: '#eaf2f8', emoji: 'ü´ê' },
      "Blackberry": { color: '#f5eef8', emoji: 'ü´ê' },
      "Carrots": { color: '#fdebd0', emoji: 'ü•ï' },
      "Hot Pepper": { color: '#fde2e2', emoji: 'üå∂Ô∏è' },
      "Sweet Pepper": { color: '#f9e79f', emoji: 'ü´ë' },
      "White Strawberry": { color: '#fadbd8', emoji: 'üçì' },
      "Celery": { color: '#d4efdf', emoji: 'ü•¨' },
      "Cherry Tomato": { color: '#fdebd0', emoji: 'üçÖ' },
      "Roma Tomato": { color: '#f9e79f', emoji: 'üçÖ' },
      "Everbearing Strawberry": { color: '#fde2e2', emoji: 'üçì' }
    };

const plantDetails = {
    "Zucchini": { 
        fullName: "Bonnie Zucchini ('Black Beauty') Squash", 
        care: "Full sun, well-drained soil; space plants 36in apart; water 1-2in weekly; fertilize monthly with balanced fertilizer; monitor for powdery mildew; hand-pollinate flowers for better yields; harvest when 6‚Äì8in long to encourage production.", 
        harvestTimeline: "50-60 days to maturity; first harvest around June 10-20; peak production July-August" 
    },
    
    "Blueberry": { 
        fullName: "Blueberry (Highbush Hybrid) 'Top Hat'", 
        care: "Full sun; acidic soil (pH 4.5-5.5); apply acid-loving plant fertilizer in spring; keep soil consistently moist but not soggy; mulch with pine needles or bark; protect with bird netting during fruiting; prune in late winter to remove dead wood.", 
        harvestTimeline: "Minimal harvest in first year (July-August); full production in 3-4 years" 
    },
    
    "Blackberry": { 
        fullName: "Blackberry 'Marion' Rubus Hybrid", 
        care: "Full sun; support with trellis; space 4-6ft apart; distinguish between primocanes (first-year) and floricanes (fruiting); prune floricanes after fruiting; mulch heavily; water deeply during bloom and fruiting; protect from birds.", 
        harvestTimeline: "Minimal harvest in first year (July-August); full production in year 2-3" 
    },
    
    "Carrots": { 
        fullName: "Burpee Carrot 'Nantes Half Long'", 
        care: "Full sun; deep, loose sandy soil free of stones; sow 1/4in deep in rows 12in apart; thin seedlings to 2in spacing; keep soil consistently moist; avoid high-nitrogen fertilizers; prevent shoulder greening with soil cover.", 
        harvestTimeline: "65-75 days to maturity; harvest around June 25-July 5" 
    },
    
    "Hot Pepper": { 
        fullName: "Hot Pepper 'Desperado' (Burpee)", 
        care: "Full sun; warm soil (60¬∞F+); space 18-24in apart; pinch early blooms to strengthen plant; use calcium-rich fertilizer to prevent blossom end rot; avoid overwatering; mulch to maintain even moisture; harvest when firm and fully colored.", 
        harvestTimeline: "85-95 days to maturity; first harvest around July 15-25" 
    },
    
    "Sweet Pepper": { 
        fullName: "Sweet Pepper (Burpee)", 
        care: "Full sun; warm soil (60¬∞F+); space 18-24in apart; support with stakes or cages for heavy fruit; water consistently (1-2in weekly); avoid high-nitrogen fertilizers once fruiting begins; harvest when firm and fully colored.", 
        harvestTimeline: "90-100 days to maturity; first harvest around July 20-30" 
    },
    
    "White Strawberry": { 
        fullName: "Strawberry 'Berries Galore¬Æ White'", 
        care: "Full sun; well-drained, fertile soil; plant 12-18in apart; mulch with straw to keep berries clean; remove runners for larger berries; water evenly (1-1.5in weekly); apply balanced fertilizer monthly; protect from birds and slugs.", 
        harvestTimeline: "50-60 days to maturity; first harvest around June 10-20" 
    },
    
    "Celery": { 
        fullName: "Celery (Bonnie)", 
        care: "Full sun to partial shade (afternoon shade in hot climates); rich, moist soil with plenty of organic matter; space 8-10in apart; keep consistently moist; blanch stalks for milder flavor by hilling soil or wrapping; mulch heavily; protect from extreme heat.", 
        harvestTimeline: "85-95 days to maturity; harvest around July 15-25" 
    },
    
    "Cherry Tomato": { 
        fullName: "Bonnie Husky Cherry Red Tomato", 
        care: "Full sun; indeterminate variety requiring tall support; space 24-36in apart; prune suckers for better air circulation; provide calcium to prevent blossom end rot; water deeply at soil level (1-2in weekly); avoid wetting foliage; harvest when fully red.", 
        harvestTimeline: "70-80 days to maturity; first harvest around July 1-10; continues until frost" 
    },
    
    "Roma Tomato": { 
        fullName: "Bonnie Roma Classic Paste Tomato", 
        care: "Full sun; determinate variety needing medium support; space 24-30in apart; water consistently to prevent cracking; provide calcium-rich fertilizer; monitor for blight; stake or cage early; harvest when firm and fully red.", 
        harvestTimeline: "75-85 days to maturity; harvest around July 5-15; concentrated harvest period" 
    },
    
    "Everbearing Strawberry": { 
        fullName: "Everbearing Strawberry (Burpee)", 
        care: "Full sun; fertile, well-drained soil with pH 5.5-6.8; space 12-18in apart; remove first set of flowers to establish plants; mulch with straw; water regularly avoiding crown; apply balanced fertilizer monthly; protect from frost and birds.", 
        harvestTimeline: "60-70 days to first harvest (around June 20-July 1); second flush in late summer/early fall" 
    }
};

    let blocks = [];

    function drawGrid() {
      ctx.clearRect(0, 0, displaySize, displaySize);
      ctx.font = "16px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      blocks = [];
      const drawn = new Set();
      for (let r = 0; r < gridSize; r++) {
        for (let c = 0; c < gridSize; c++) {
          const idx = r * gridSize + c + 1;
          if (drawn.has(idx)) continue;
          const label = plantMap[idx] || "";
          let w = 1, h = 1;
          if (label) {
            while (c + w < gridSize && plantMap[idx + w] === label) w++;
            let ok = true;
            while (r + h < gridSize && ok) {
              for (let dx = 0; dx < w; dx++) {
                if (plantMap[idx + h * gridSize + dx] !== label) { ok = false; break; }
              }
              if (ok) h++;
            }
          }
          for (let dy = 0; dy < h; dy++) for (let dx = 0; dx < w; dx++) drawn.add(idx + dy * gridSize + dx);
          drawBlock(c, r, w, h, label, idx);
        }
      }
    }

    function drawBlock(col, row, w, h, label, idx) {
      const x = col * cellSize, y = row * cellSize;
      if (label && styleMap[label]) {
        ctx.globalAlpha = 0.2;
        ctx.fillStyle = styleMap[label].color;
        ctx.fillRect(x, y, w * cellSize, h * cellSize);
        ctx.globalAlpha = 1;
      }
      if (idx === selectedIndex) {
        ctx.globalAlpha = 0.2;
        ctx.fillStyle = '#007acc';
        ctx.fillRect(x, y, w * cellSize, h * cellSize);
        ctx.globalAlpha = 1;
        ctx.lineWidth = 2; ctx.strokeStyle = '#007acc';
      } else {
        ctx.lineWidth = 1; ctx.strokeStyle = '#666';
      }
      ctx.strokeRect(x, y, w * cellSize, h * cellSize);
      if (label) {
        const emoji = styleMap[label]?.emoji || '';
        const cx = x + (w * cellSize)/2;
        const cy = y + (h * cellSize)/2;
        ctx.fillStyle = '#333';
        ctx.fillText(emoji, cx, cy - 10);
        ctx.fillText(label, cx, cy + 12);
      }
      blocks.push({ x, y, w: w*cellSize, h: h*cellSize, label, idx });
    }

    function titleCase(str) {
      return str.toLowerCase().replace(/(^|[^a-zA-Z])([a-z])/g, (m, sep, char) => sep + char.toUpperCase());
    }

    canvas.addEventListener('click', e => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const blk = blocks.find(b => x >= b.x && x <= b.x + b.w && y >= b.y && y <= b.y + b.h);
      if (blk && blk.label) {
        selectedIndex = blk.idx;
        const detail = plantDetails[blk.label];
        if (detail) {
          infoDiv.innerHTML = `<h3>${titleCase(detail.fullName)}</h3><p>Care:<br/>${titleCase(detail.care)}</p><br/><p>Harvest Timeline:<br/>${titleCase(detail.harvestTimeline)}</p>`;
        } else infoDiv.innerHTML = `<em>No data available.</em>`;
      } else {
        selectedIndex = null;
        infoDiv.innerHTML = `<em>Click a section to see plant care instructions and harvest timeline.</em>`;
      }
      drawGrid();
    });

    document.addEventListener('click', e => {
      if (e.target !== canvas) {
        selectedIndex = null;
        infoDiv.innerHTML = `<em>Click a section to see plant care instructions.</em>`;
        drawGrid();
      }
    });

    drawGrid();
  </script>
</body>
</html>
